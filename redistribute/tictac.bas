1X=RND(-TIMER):ONBRKGOTO1000:RGB:WIDTH40:PALETTE0,0:PALETTE8,25:DIMA(9),B(4),C(24),D(4),E(4):FORI=1TO24:READC(I):NEXTI:FORI=1TO4:READB(I):NEXTI:FORI=1TO4:READD(I):NEXTI
5PRINT:PRINT"TIC TAC TOE":FORI=1TO9:A(I)=I+16:NEXTI:GOSUB100:FORI=1TO9:A(I)=0:NEXTI
10PRINT:PRINT"Your move";:INPUTM:M=INT(M):IFM<1OR M>9 THENPRINT"Illegal move":GOTO10
11IFA(M)>0 THENPRINT"Illegal move":GOTO10
12A(M)=56:GOSUB100:GOSUB300:IFX=3 THENGOTO30
13IFN=24 THENGOTO40
14GOSUB200:GOSUB100:GOSUB300:IFO=3 THENGOTO35
15IFN=24 THENGOTO40
16GOTO10
30PRINT:PRINT"Player wins!":GOTO5
35PRINT:PRINT"Computer wins!":GOTO5
40PRINT:PRINT"Tie game!":GOTO5
100PRINT:FORI=1TO3:PRINT" ";:FORJ=1TO3:K=(I-1)*3+J:PRINTCHR$(A(K)+32);:IFJ<3 THENPRINT" ! ";
101NEXTJ:PRINT:IFI<>3 THENPRINT"---+---+---"
102NEXTI:RETURN
200GOSUB400:IFM>0 THENGOTO220
201GOSUB900:IFM>0 THENGOTO220
202GOSUB500:IFM>0 THENGOTO220
203GOSUB600:IFM>0 THENGOTO220
204GOSUB700:IFM>0 THENGOTO220
205GOSUB800
220A(M)=47:PRINT:PRINT"Computer's move:";M;:PRINT"(";F$;")";:PRINT:RETURN
300N=0:S=0:FORI=1TO9:S=S*3:IFA(I)=47 THENS=S+1
301IFA(I)=56 THENS=S+2
302NEXTI:FORI=1TO22 STEP3:X=0:O=0:FORJ=I TO I+2:IFA(C(J))>0 THENN=N+1
303IFA(C(J))=56 THENX=X+1
304IFA(C(J))=47 THENO=O+1
305NEXTJ:IFX=3 THENRETURN
306IFO=3 THENRETURN
307IFN=24 THENRETURN
308NEXTI:RETURN
400M=0:W=0:B=0:FORI=1TO22 STEP3:N=0:X=0:O=0:E=0:FORJ=I TO I+2:IFA(C(J))>0 THENN=N+1
401IFA(C(J))=56 THENX=X+1
402IFA(C(J))=47 THENO=O+1
403IFA(C(J))=0 THENE=C(J)
404NEXTJ:IFN<3AND O=2 THENW=E
405IFN<3AND X=2 THENB=E
406NEXTI:IFW>0 THENM=W:F$="WIN":RETURN
407IFB>0 THENM=B:F$="BLOCK"
408RETURN
500F$="CENTER":IFA(5)=0 THENM=5
501RETURN
600F$="NOFORK":IFS=13205OR S=1557 THENM=B(INT(4*RND(0))+1)
601RETURN
700C=0:F$="CORNER":FORI=1TO4:IFA(D(I))=0 THENC=C+1:E(C)=D(I)
701NEXTI:IFC>0 THENM=E(INT(C*RND(0))+1)
702RETURN
800F$="RANDOM"
810M=INT(9*RND(0))+1:IFA(M)<>0 THENGOTO810
811RETURN
900F$="DUMB":IFINT(100*RND(0))+1<20 THENGOSUB810
901RETURN
1000POKE&H71,0:EXEC&H8C1B
1001DATA1,2,3,4,5,6,7,8,9,1,4,7,2,5,8,3,6,9,1,5,9,3,5,7,2,4,6,8,1,3,7,9
