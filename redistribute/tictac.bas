1X=RND(-TIMER):ONBRKGOTO1000:RGB:WIDTH40:PALETTE0,0:PALETTE9,25:DIMA(9),L(24):FORI=1TO24:READL(I):NEXTI
5PRINT:PRINT"TIC TAC TOE":FORI=1TO9:A(I)=I+16:NEXTI:GOSUB100:FORI=1TO9:A(I)=0:NEXTI
10PRINT:PRINT"Your move";:INPUTM:M=INT(M):IFM<1OR M>9 THENPRINT"Illegal move":GOTO10
11IFA(M)>0 THENPRINT"Illegal move":GOTO10
25A(M)=56:GOSUB100:GOSUB300:IFX=3 THENPRINT:PRINT"Player wins!":GOTO5
26IFN=24 THENPRINT:PRINT"Tie game!":GOTO5
27GOSUB200:GOSUB100:GOSUB300:IFO=3 THENPRINT:PRINT"Computer wins!":GOTO5
28IFN=24 THENPRINT:PRINT"Tie game!":GOTO5
29GOTO10
100PRINT:FORI=1TO3:PRINT" ";:FORJ=1TO3:K=(I-1)*3+J:PRINTCHR$(A(K)+32);:IFJ<3 THENPRINT" ! ";
101NEXTJ:PRINT:IFI<>3 THENPRINT"---+---+---"
102NEXTI:RETURN
200GOSUB400:IFM<>0 THENGOTO220
201IFA(5)>0 THENGOTO210:M=5
210M=INT(9*RND(0))+1:IFA(M)<>0 THENGOTO210
220A(M)=47:PRINT:PRINT"Computer's move:";M:RETURN
300N=0:FORI=1TO22 STEP3:X=0:O=0:FORJ=I TO I+2:V=A(L(J)):IFV>0 THENN=N+1
301IFV=56 THENX=X+1
302IFV=47 THENO=O+1
303NEXTJ:IFX=3OR O=3 THENRETURN
304NEXTI:RETURN
400M=0:FORI=1TO22 STEP3:N=0:X=0:O=0:E=0:FORJ=I TO I+2:IFA(L(J))=56 THENX=X+1 ELSE IF A(L(J))=47 THENO=O+1
401IFA(L(J))=0 THENE=L(J) ELSEN=N+1
402NEXTJ:IFN<3AND O=2 THENM=E:RETURN
403IFN<3AND X=2 THENM=E:RETURN
404NEXTI:RETURN
1000POKE&H71,0:EXEC&H8C1B
1001DATA1,2,3,4,5,6,7,8,9,1,4,7,2,5,8,3,6,9,1,5,9,3,5,7
